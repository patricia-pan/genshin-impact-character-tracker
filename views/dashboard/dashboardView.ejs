<h1>My Goals</h1>

<div class="translucent dashboard">
    <% myCharacters.forEach(character => { %>

    <div class="goal-wrapper translucent">
        <div class="goal-header flex-row">
            <img src='/img/headshots/<%= character.name.toLowerCase() %>.png' width='40px' height='40px' style="margin-top: -5px;margin-right:6px;"> 
            <h3 style="vertical-align:bottom;color: #0f4150"><%= character.name %></h3>
        </div>
        <%# Goals code previously went here. %>

        <ul class="goal-content">
        <% if (character.goals) { %>
        <% character.goals.forEach(goal => { %>  
            <p><li class="<%= character.vision %> li-align-left"><%= goal.li %></li></p>
        <% }) %>
        <% } %>
        </ul>
    </div> <%# End of goal wrapper. %>
    <% }) %>



    <%# START OF NEW CODE %>
    <form action="/goal/delete/?_method=DELETE" method="POST" id="deleteMyChar" name="characters">
                    
        <% myCharacters.forEach(character => { %>
        <div class="flex-col">
            <img src='/img/headshots/<%= character.name.toLowerCase() %>.png' width='40px' height='40px' style="margin-top: -5px;margin-right:6px;"> 
            <h3 class="<%= character.vision %>"><%= character.name %></h3>
            <input type="checkbox" id="<%= character.name %>" value="<%= character.id %>" style="width:65px;" class="bottom">
            <label for="<%= character.name %>"><%= character.name %></label>
        </div>
        <% }) %>


        <button type="submit" form="deleteMyChar">Delete</button>
    </form>
    <%# END OF NEW CODE %>



    <form action='/dashboard/goal/add' method='POST'>
        <div class="width main">
            <label for="characters">Character:</label>
            <%# How to create dynamic select form: https://stackoverflow.com/questions/42548641/how-to-get-value-selected-in-dropdown-menu-from-ejs-template-to-server-side-node %>
            <%# Bootstrap-select options: https://developer.snapappointments.com/bootstrap-select/examples/ %>
            <%# data-action-box adds 'Select All' and 'Deselect All' buttons. %>
            <select class="selectpicker" id="characters" name="myCharId" title="Choose one of your characters." data-live-search="true" data-actions-box="true" data-width="60%" required>
                <optgroup label="5 Star Characters">
                    <% myCharacters.forEach(character => { %>
                        <% if (character.rarity == 5) { %>
                            <option value="<%= character.id %>"> <%= character.name %> </option>
                        <% } %>
                    <% }) %>
                </optgroup>
                <optgroup label="4 Star Characters">
                    <% myCharacters.forEach(character => { %>
                        <% if (character.rarity == 4) { %>
                            <option value="<%= character.id %>"> <%= character.name %> </option>
                        <% } %>
                    <% }) %>
                </optgroup>
            </select>
        </div>
        <div>
            <label for="goal" style="vertical-align:top">Goal:</label>
            <textarea id="goal" placeholder="Add notes here." value="" name="goal" rows="4" cols="50"></textarea>
        </div>
        
        <div>
            <input type='submit' value="Add New Goal to Character">
        </div>
    </form>
    
</div>